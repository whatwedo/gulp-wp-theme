!function($){acf.field_group_pro={init:function(){var e=this;acf.add_action("open_field sortstop",function(a){e.update_field_parent(a)}),acf.add_action("duplicate_field",function(a){e.duplicate_field(a)}),acf.add_action("delete_field",function(a){e.delete_field(a)}),acf.add_action("change_field_type",function(a){e.change_field_type(a)}),this.repeater.init(),this.flexible_content.init()},fix_conditional_logic:function(e){var a={};e.each(function(){a[$(this).attr("data-orig")]=$(this).attr("data-key")}),e.find(".conditional-logic-field").each(function(){var e=$(this).val();e in a&&($(this).find('option[value="'+a[e]+'"]').exists()||$(this).append('<option value="'+a[e]+'">'+a[e]+"</option>"),$(this).val(a[e]))})},update_field_parent:function(e){if(e.hasClass("acf-field-object")){var a=e.parent().closest(".acf-field-object"),t=0;if(a.exists()){var i=acf.get_data(a,"id"),f=acf.get_data(a,"key");t=f,i&&(t=i)}acf.field_group.update_field_meta(e,"parent",t),acf.do_action("update_field_parent",e,a)}},duplicate_field:function(e){var a=e.find(".acf-field-object").not('[data-key="acfcloneindex"]');a.exists()&&(a.each(function(){var e=$(this).parent().closest(".acf-field-object"),a=acf.field_group.get_field_meta(e,"key");acf.field_group.wipe_field($(this)),acf.field_group.update_field_meta($(this),"parent",a),acf.field_group.save_field($(this))}),this.fix_conditional_logic(a))},delete_field:function(e){e.find(".acf-field-object").each(function(){acf.field_group.delete_field($(this),!1)})},change_field_type:function(e){e.find(".acf-field-object").each(function(){acf.field_group.delete_field($(this),!1)})}},acf.field_group_pro.repeater={init:function(){var e=this;acf.add_action("open_field change_field_type",function(a){e.render_field(a)}),$(document).on("change",".acf-repeater-layout input",function(){e.render_field($(this).closest(".acf-field-object"))})},render_field:function(e){if("repeater"==e.attr("data-type")){var a=e.find("> .settings > table > tbody"),t=a.find('> [data-name="sub_fields"] .acf-field-list:first'),i=a.find('> [data-name="layout"] input:checked').val();t.removeClass("layout-row layout-table").addClass("layout-"+i),t.hasClass("ui-sortable")||acf.field_group.sort_fields(t)}}},acf.field_group_pro.flexible_content={init:function(){var e=this;acf.add_action("open_field change_field_type",function(a){e.render_field(a)}),acf.add_action("update_field_parent",function(a,t){e.update_field_parent(a,t)}),$(document).on("click",'[data-name="acf-fc-add"]',function(a){a.preventDefault(),e.add_layout($(this).closest(".acf-field"))}),$(document).on("click",'[data-name="acf-fc-duplicate"]',function(a){a.preventDefault(),e.duplicate_layout($(this).closest(".acf-field"))}),$(document).on("click",'[data-name="acf-fc-delete"]',function(a){a.preventDefault(),e.delete_layout($(this).closest(".acf-field"))}),$(document).on("blur",".acf-fc-meta-label input",function(a){e.change_layout_label($(this))}),$(document).on("change",".acf-fc-meta-display select",function(a){e.render_layout($(this).closest(".acf-field"))})},add_layout:function(e){var a=e.clone(!1);a.find(".acf-field-object").not('[data-key="acfcloneindex"]').remove(),a.find(".no-fields-message").show(),a.find(".acf-fc-meta input").val(""),this.wipe_layout(a),e.after(a),a.find(".acf-field-list").each(function(){acf.field_group.sort_fields($(this))}),a.find(".acf-fc-meta select").val("row").trigger("change")},wipe_layout:function(e){var a=e.attr("data-key"),t=acf.get_uniqid();e.attr("data-key",t),e.find('> .acf-input > .acf-hidden [data-name="layout-key"]').val(t),e.find('[id*="'+a+'"]').each(function(){$(this).attr("id",$(this).attr("id").replace("-layouts-"+a+"-","-layouts-"+t+"-"))}),e.find('[name*="'+a+'"]').each(function(){$(this).attr("name",$(this).attr("name").replace("[layouts]["+a+"]","[layouts]["+t+"]"))})},duplicate_layout:function(e){acf.do_action("before_duplicate",e);var a=e.clone(!1);this.wipe_layout(a);var t=a.attr("data-key"),i=a.find(".acf-field-object").not('[data-key="acfcloneindex"]');i.each(function(){acf.field_group.wipe_field($(this)),acf.field_group.update_field_meta($(this),"parent_layout",t),acf.field_group.save_field($(this))}),e.after(a),acf.do_action("after_duplicate",e,a),acf.field_group_pro.fix_conditional_logic(i),a.find(".acf-field-list").each(function(){acf.field_group.sort_fields($(this))}),a.find(".acf-fc-meta-label input").focus()},delete_layout:function(e){return 0==e.siblings('tr[data-name="fc_layout"]').length?(alert(acf._e("flexible_content","layout_warning")),!1):(e.find(".acf-field-object").not('[data-key="acfcloneindex"]').each(function(){acf.field_group.delete_field($(this),!1)}),acf.field_group.save_field(e.closest(".acf-field-object")),void acf.remove_tr(e))},change_layout_label:function(e){var a=e.closest(".acf-fc-meta").find(".acf-fc-meta-name input");if(""==a.val()){var t=e.val(),i={"ä":"a","æ":"a","å":"a","ö":"o","ø":"o","é":"e","ë":"e","ü":"u","ó":"o","ő":"o","ú":"u","é":"e","á":"a","ű":"u","í":"i"," ":"_","'":"","\\?":""};$.each(i,function(e,a){var i=new RegExp(e,"g");t=t.replace(i,a)}),t=t.toLowerCase(),a.val(t).trigger("change")}},render_field:function(e){if("flexible_content"==e.attr("data-type")){var a=this,t=e.find("> .settings > table > tbody");t.hasClass("ui-sortable")||t.sortable({items:'> tr[data-name="fc_layout"]',handle:'[data-name="acf-fc-reorder"]',forceHelperSize:!0,forcePlaceholderSize:!0,scroll:!0,start:function(e,a){acf.do_action("sortstart",a.item,a.placeholder)},stop:function(a,t){acf.do_action("sortstop",t.item,t.placeholder),acf.field_group.save_field(e)}}),t.children('tr[data-name="fc_layout"]').each(function(){a.render_layout($(this))})}},render_layout:function(e){var a=e.find(".acf-fc-meta:first .acf-fc-meta-display select").val(),t=e.find(".acf-field-list:first");t.removeClass("layout-row layout-table").addClass("layout-"+a),t.hasClass("ui-sortable")||acf.field_group.sort_fields(t);var i=e.attr("data-key");t.children(".acf-field-object").each(function(){acf.field_group.update_field_meta($(this),"parent_layout",i)})},update_field_parent:function(e,a){if(!a.exists())return void acf.field_group.delete_field_meta(e,"parent_layout");var t=e.closest("tr.acf-field");if("fc_layout"==t.attr("data-name")){var i=acf.field_group.get_field_meta(e,"parent_layout"),f=t.attr("data-key");i!=f&&(acf.field_group.update_field_meta(e,"parent_layout",f),acf.field_group.save_field(e))}}},acf.add_action("ready",function(){acf.field_group_pro.init()})}(jQuery);
