!function($){function e(e){var t=e.find('[data-name="toggle-select-ui"]:checked').val();"1"==t?e.find('.acf-field[data-name="ajax"]').show():e.find('.acf-field[data-name="ajax"]').hide()}function t(e){var t=e.find('[data-name="toggle-radio-other"]');t.is(":checked")?e.find('.acf-field[data-name="save_other_choice"]').show():(e.find('.acf-field[data-name="save_other_choice"]').hide(),e.find('.acf-field[data-name="save_other_choice"] input').removeAttr("checked"))}function i(e){$.each(["display_format","return_format"],function(t,i){var a=e.find('.acf-field[data-name="'+i+'"] input[type="radio"]:checked'),n=e.find('.acf-field[data-name="'+i+'"] input[type="text"]');"other"!=a.val()&&n.val(a.val())})}acf.field_group={$fields:null,$locations:null,$options:null,fields:{},conditions:{},locations:{},options:{},focus:function(e){return e.closest(".acf-field-object")},init:function(){var e=this;this.$fields=$("#acf-field-group-fields"),this.$locations=$("#acf-field-group-locations"),this.$options=$("#acf-field-group-options"),this.$fields.addClass("acf-postbox seamless"),this.$locations.addClass("acf-postbox"),this.$options.addClass("acf-postbox"),this.sort_fields($(".acf-field-list:first")),$(document).on("submit","#post",function(){return e.submit()}),$(document).on("click","#submitdiv .submitdelete",function(){return e.trash()}),$(document).on("change",'#adv-settings input[name="show_field_keys"]',function(){e.toggle_field_keys($(this).val())}),this.$fields.on("click",".edit-field",function(t){t.preventDefault(),e.edit_field(e.focus($(this)))}),this.$fields.on("click",".duplicate-field",function(t){t.preventDefault(),e.duplicate_field(e.focus($(this)))}),this.$fields.on("click",".move-field",function(t){t.preventDefault(),e.move_field(e.focus($(this)))}),this.$fields.on("click",".delete-field",function(t){t.preventDefault(),e.delete_field(e.focus($(this)))}),this.$fields.on("click",".acf-add-field",function(t){t.preventDefault(),e.add_field($(this).closest(".acf-field-list-wrap").children(".acf-field-list"))}),this.$fields.on("change",'tr[data-name="type"] select',function(){e.change_field_type($(this))}),this.$fields.on("blur",'tr[data-name="label"] input',function(t){e.change_field_label(e.focus($(this)))}),this.$fields.on("blur",'tr[data-name="name"] input',function(t){e.change_field_name(e.focus($(this)))}),this.$fields.on("keyup",'tr[data-name="label"] input, tr[data-name="name"] input',function(t){e.render_field(e.focus($(this)))}),this.$fields.on("change","input, textarea, select",function(t){e.save_field(e.focus($(this)))}),acf.add_filter("get_fields",function(e){return e=e.not('.acf-field-object[data-key="acfcloneindex"] .acf-field')},99),this.conditions.init(),this.locations.init(),this.options.init(),this.render()},render:function(){var e=acf.serialize_form($("#adv-settings"));e.show_field_keys=parseInt(e.show_field_keys),e.show_field_keys?this.$fields.addClass("show-field-keys"):this.$fields.removeClass("show-field-keys")},toggle_field_keys:function(e){e=parseInt(e),acf.update_user_setting("show_field_keys",e),e?this.$fields.addClass("show-field-keys"):this.$fields.removeClass("show-field-keys")},get_field_meta:function(e,t){var i=e.children(".meta").children(".input-"+t);return i.exists()?i.val():!1},update_field_meta:function(e,t,i){var a=e.children(".meta").children(".input-"+t);if(!a.exists()){var n=e.children(".meta").children(".input-ID").outerHTML().replace(/ID/g,t);a=$(n),a.val(i),e.children(".meta").append(a)}a.val()!=i&&(a.val(i),"save"!=t&&this.save_field(e,"meta"))},delete_field_meta:function(e,t){var i=e.children(".meta").children(".input-"+t);i.exists()&&i.remove(),this.save_field(e,"meta")},save_field:function(e,t){t=t||"settings";var i=this.get_field_meta(e,"save");"settings"!=i&&i!=t&&(this.update_field_meta(e,"save",t),acf.do_action("save_field",e,t))},submit:function(){var e=this,t=$("#titlewrap #title");return t.val()?(e.$fields.find(".acf-field-object").each(function(){var t=e.get_field_meta($(this),"save"),i=e.get_field_meta($(this),"ID"),a=$(this).hasClass("open");return"acfcloneindex"==i?void $(this).remove():(a&&e.close_field($(this)),void("settings"==t||("meta"==t?$(this).children(".settings").find('[name^="acf_fields['+i+']"]').remove():$(this).find('[name^="acf_fields['+i+']"]').remove())))}),!0):($("#submitdiv").exists()&&($("#submitdiv").find(".disabled").removeClass("disabled"),$("#submitdiv").find(".button-disabled").removeClass("button-disabled"),$("#submitdiv").find(".button-primary-disabled").removeClass("button-primary-disabled"),$("#submitdiv .spinner").hide()),alert(acf._e("title_is_required")),t.focus(),!1)},trash:function(){return confirm(acf._e("move_to_trash"))},sort_fields:function(e){e.sortable({connectWith:".acf-field-list",update:function(e,t){var i=t.item;acf.field_group.render_fields(),acf.do_action("sortstop",i)},handle:".acf-icon"})},render_fields:function(){var e=this;this.$fields.find(".acf-field-list").each(function(){var t=$(this).children(".acf-field-object").not('[data-id="acfcloneindex"]');t.each(function(t){e.update_field_meta($(this),"menu_order",t),$(this).children(".handle").find(".acf-icon").html(t+1)}),t.exists()?$(this).children(".no-fields-message").hide():$(this).children(".no-fields-message").show()})},render_field:function(e){var t=e.find('tr[data-name="label"]:first input').val(),i=e.find('tr[data-name="name"]:first input').val(),a=e.find('tr[data-name="type"]:first select option:selected').text();e.find("> .handle .li-field-label strong a").text(t),e.find("> .handle .li-field-name").text(i),e.find("> .handle .li-field-type").text(a)},edit_field:function(e){e.hasClass("open")?this.close_field(e):this.open_field(e)},open_field:function(e){return e.hasClass("open")?!1:(e.addClass("open"),acf.do_action("open_field",e),void e.children(".settings").animate({height:"toggle"},250))},close_field:function(e){return e.hasClass("open")?(e.removeClass("open"),acf.do_action("close_field",e),void e.children(".settings").animate({height:"toggle"},250)):!1},wipe_field:function(e){var t=e.attr("data-id"),i=e.attr("data-key"),a=acf.get_uniqid("field_");e.attr("data-orig",i),e.attr("data-key",a),e.attr("data-id",a),this.update_field_meta(e,"ID",""),this.update_field_meta(e,"key",a),e.find('[id*="'+t+'"]').each(function(){$(this).attr("id",$(this).attr("id").replace(t,a))}),e.find('[name*="'+t+'"]').each(function(){$(this).attr("name",$(this).attr("name").replace(t,a))}),e.find("> .handle .pre-field-key").text(a),e.find(".ui-sortable").removeClass("ui-sortable"),acf.do_action("wipe_field",e)},duplicate_field:function(e){acf.do_action("before_duplicate",e);var t=e.clone(),i=e.closest(".acf-field-list");acf.do_action("remove",t),this.wipe_field(t),e.after(t),acf.do_action("after_duplicate",e,t),setTimeout(function(){t.find('tr[data-name="label"]:first input').focus()},251),this.render_fields(),acf.do_action("append",t),e.hasClass("open")?this.close_field(e):this.open_field(t);var a=t.find('tr[data-name="label"]:first input'),n=t.find('tr[data-name="name"]:first input');a.val(a.val()+" ("+acf._e("copy")+")"),n.val(n.val()+"_"+acf._e("copy")),this.save_field(t),this.render_field(t),acf.do_action("duplicate_field",t)},move_field:function(e){var t=this,i=acf.prepare_for_ajax({action:"acf/field_group/move_field",field_id:e.data("id")}),a=!1;return i.field_id?"settings"==this.get_field_meta(e,"save")?a=!0:e.find(".acf-field-object").not('[data-id="acfcloneindex"]').each(function(){return $(this).data("id")?void("settings"==t.get_field_meta($(this),"save")&&(a=!0)):(a=!0,!1)}):a=!0,a?void alert(acf._e("move_field_warning")):(acf.open_popup({title:acf._e("move_field"),loading:!0,height:220}),void $.ajax({url:acf.get("ajaxurl"),data:i,type:"post",dataType:"html",success:function(i){t.move_field_confirm(e,i)}}))},move_field_confirm:function(e,t){var i=this;acf.update_popup({content:t});var a={action:"acf/field_group/move_field",nonce:acf.get("nonce"),field_id:this.get_field_meta(e,"ID"),field_group_id:0};$("#acf-move-field-form").on("submit",function(){return a.field_group_id=$(this).find("select").val(),$.ajax({url:acf.get("ajaxurl"),data:a,type:"post",dataType:"html",success:function(t){acf.update_popup({content:t}),i.remove_field(e)}}),!1})},delete_field:function(e,t){t=t||!0;var i=this.get_field_meta(e,"ID");"acfcloneindex"!=i&&(i&&$("#input-delete-fields").val($("#input-delete-fields").val()+"|"+i),acf.do_action("delete_field",e),t&&this.remove_field(e))},remove_field:function(e){var t=this,i=e.closest(".acf-field-list");e.css({height:e.height(),width:e.width(),position:"absolute"}),e.wrap('<div class="temp-field-wrap" style="height:'+e.height()+'px"></div>'),e.animate({opacity:0},250);var a=0,n=!1;1==i.children(".acf-field-object").length&&(n=i.children(".no-fields-message"),a=n.outerHeight()),e.parent(".temp-field-wrap").animate({height:a},250,function(){n&&n.show(),acf.do_action("remove",$(this)),$(this).remove(),t.render_fields()})},add_field:function(e){var t=e.children('.acf-field-object[data-key="acfcloneindex"]'),i=t.clone();this.wipe_field(i),i.show(),t.before(i),e.children(".no-fields-message").hide(),i.find('.settings input[type="text"]').val(""),setTimeout(function(){i.find('input[type="text"]:first').focus()},251),this.render_fields(),acf.do_action("append",i),this.edit_field(i),acf.do_action("add_field",i)},change_field_type:function(e){var t=e.closest("tbody"),i=t.closest(".acf-field-object"),a=i.parent().closest(".acf-field-object"),n=i.attr("data-key"),d=i.attr("data-type"),l=e.val();i.removeClass("acf-field-object-"+d.replace("_","-")),i.addClass("acf-field-object-"+l.replace("_","-")),i.attr("data-type",l),i.data("xhr")&&i.data("xhr").abort();var o=t.children('tr[data-setting="'+d+'"]'),c="";if(o.each(function(){c+=$(this).outerHTML()}),o.remove(),acf.update(n+"_settings_"+d,c),this.render_field(i),c=acf.get(n+"_settings_"+l))return t.children('.acf-field[data-name="conditional_logic"]').before(c),acf.update(n+"_settings_"+l,""),void acf.do_action("change_field_type",i);var f=$('<tr class="acf-field"><td class="acf-label"></td><td class="acf-input"><div class="acf-loading"></div></td></tr>');t.children('.acf-field[data-name="conditional_logic"]').before(f);var s={action:"acf/field_group/render_field_settings",nonce:acf.o.nonce,parent:acf.o.post_id,field_group:acf.o.post_id,prefix:e.attr("name").replace("[type]",""),type:l};a.exists()&&(s.parent=this.get_field_meta(a,"ID"));var r=$.ajax({url:acf.o.ajaxurl,data:s,type:"post",dataType:"html",success:function(e){if(e){var t=$(e);f.after(t),acf.do_action("append",t),acf.do_action("change_field_type",i)}},complete:function(){f.remove()}});i.data("xhr",r)},change_field_label:function(e){var t=e.find('tr[data-name="label"]:first input'),i=e.find('tr[data-name="name"]:first input'),a=e.attr("data-type");if(""==i.val()){var n=t.val(),d={"ä":"a","æ":"a","å":"a","ö":"o","ø":"o","é":"e","ë":"e","ü":"u","ó":"o","ő":"o","ú":"u","é":"e","á":"a","ű":"u","í":"i"," ":"_","'":"","\\?":""};$.each(d,function(e,t){var i=new RegExp(e,"g");n=n.replace(i,t)}),n=n.toLowerCase(),i.val(n).trigger("change")}this.render_field(e),acf.do_action("change_field_label",e)},change_field_name:function(e){var t=e.find('tr[data-name="name"]:first input');"field_"===t.val().substr(0,6)&&(alert(acf._e("field_name_start")),setTimeout(function(){t.focus()},1))}},acf.field_group.conditions={$el:null,init:function(){this.$el=acf.field_group.$fields;var e=this;acf.add_action("open_field",function(t){e.render(t)}),acf.add_action("change_field_label change_field_type",function(t){e.$el.find(".acf-field-object.open").each(function(){e.render($(this))})}),e.$el.on("change",'tr[data-name="conditional_logic"] input[type="radio"]',function(t){t.preventDefault(),e.change_toggle($(this))}),e.$el.on("change",".conditional-logic-field",function(t){t.preventDefault(),e.change_trigger($(this))}),e.$el.on("click",".location-add-rule",function(t){t.preventDefault(),e.add_rule($(this).closest("tr"))}),e.$el.on("click",".location-remove-rule",function(t){t.preventDefault(),e.remove_rule($(this).closest("tr"))}),e.$el.on("click",".location-add-group",function(t){t.preventDefault(),e.add_group($(this).closest(".location-groups"))})},update_select:function(e,t){t&&0!=t.length||(t=[{value:"",label:""}]);var i=e.val();e.html(""),$.each(t,function(t,i){var a=e;i.group&&(a=e.find('optgroup[label="'+i.group+'"]'),a.exists()||(a=$('<optgroup label="'+i.group+'"></optgroup>'),e.append(a))),a.append('<option value="'+i.value+'">'+i.label+"</option>")}),e.find('option[value="'+i+'"]').exists()&&e.val(i)},render:function(e){var t=this,i=[],a=e.attr("data-key"),n=e.parents(".acf-field-list"),d=e.find('> .settings > table > tbody > tr[data-name="conditional_logic"]');$.each(n,function(e){var t=0==e?acf.l10n.sibling_fields:acf.l10n.parent_fields;$(this).children(".acf-field-object").each(function(){var e=$(this),n=e.attr("data-key"),d=e.attr("data-type"),l=e.find('> .settings > table > tbody > tr[data-name="label"] input').val();"acfcloneindex"!=n&&n!=a&&("select"==d||"checkbox"==d||"true_false"==d||"radio"==d)&&i.push({value:n,label:l,group:t})})}),0==i.length&&i.push({value:"",label:acf.l10n.no_fields}),d.find(".conditional-logic-field").each(function(){t.update_select($(this),i),t.change_trigger($(this))})},change_toggle:function(e){var t=e.val(),i=e.closest(".acf-input");"1"==t?(i.find(".location-groups").show(),i.find(".location-groups").find("[name]").removeAttr("disabled")):(i.find(".location-groups").hide(),i.find(".location-groups").find("[name]").attr("disabled","disabled"))},change_trigger:function(e){var t=e.val(),i=this.$el.find('.acf-field-object[data-key="'+t+'"]'),a=i.attr("data-type"),n=e.closest("tr").find(".conditional-logic-value"),d=[];if("true_false"==a)d=[{value:1,label:acf.l10n.checked}];else if("select"==a||"checkbox"==a||"radio"==a){var l=i.find('tr[data-name="choices"] textarea').val().split("\n");if(l)for(var o=0;o<l.length;o++){var c=l[o].split(":"),f=c[0];c[1]&&(f=c[1]),d.push({value:$.trim(c[0]),label:$.trim(f)})}$allow_null=i.find('tr[data-name="allow_null"]'),$allow_null.exists()&&"1"==$allow_null.find("input:checked").val()&&d.unshift({value:"",label:acf._e("null")})}this.update_select(n,d)},add_rule:function(e){var t=e.clone(),i=t.attr("data-id"),a=acf.get_uniqid();t.find("[name]").each(function(){$(this).attr("name",$(this).attr("name").replace(i,a)),$(this).attr("id",$(this).attr("id").replace(i,a))}),t.attr("data-id",a),e.after(t),acf.field_group.save_field(e.closest(".acf-field-object"))},remove_rule:function(e){var t=e.siblings("tr").length;acf.field_group.save_field(e.closest(".acf-field-object")),0==t?this.remove_group(e.closest(".location-group")):e.remove()},add_group:function(e){var t=e.find(".location-group:last"),i=t.clone(),a=i.attr("data-id"),n=acf.get_uniqid();i.find("[name]").each(function(){$(this).attr("name",$(this).attr("name").replace(a,n)),$(this).attr("id",$(this).attr("id").replace(a,n))}),i.attr("data-id",n),i.find("h4").text(acf.l10n.or),i.find("tr:not(:first)").remove(),t.after(i)},remove_group:function(e){e.remove()}},acf.field_group.locations={$el:null,init:function(){this.$el=acf.field_group.$locations;var e=this;e.$el.on("click",".location-add-rule",function(t){t.preventDefault(),e.add_rule($(this).closest("tr"))}),e.$el.on("click",".location-remove-rule",function(t){t.preventDefault(),e.remove_rule($(this).closest("tr"))}),e.$el.on("click",".location-add-group",function(t){t.preventDefault(),e.add_group()}),e.$el.on("change",".param select",function(){e.change_rule($(this))})},add_rule:function(e){var t=e.clone(),i=t.attr("data-id"),a=acf.get_uniqid();return t.find("[name]").each(function(){$(this).attr("name",$(this).attr("name").replace(i,a)),$(this).attr("id",$(this).attr("id").replace(i,a))}),t.attr("data-id",a),t.find("option[selected]").removeAttr("selected"),e.after(t),!1},remove_rule:function(e){var t=e.siblings("tr").length;0==t?this.remove_group(e.closest(".location-group")):e.remove()},add_group:function(){var e=this.$el.find(".location-group:last"),t=e.clone(),i=t.attr("data-id"),a=acf.get_uniqid();t.find("[name]").each(function(){$(this).attr("name",$(this).attr("name").replace(i,a)),$(this).attr("id",$(this).attr("id").replace(i,a))}),t.attr("data-id",a),t.find("h4").text(acf.l10n.or),t.find("tr:not(:first)").remove(),e.after(t)},remove_group:function(e){e.remove()},change_rule:function(e){var t=e.closest("tr"),i=t.attr("data-id"),a=t.closest(".location-group"),n=a.attr("data-id"),d=$('<div class="acf-loading"></div>');t.find("td.value").html(d),$.ajax({url:acf.get("ajaxurl"),data:acf.prepare_for_ajax({action:"acf/field_group/render_location_value",rule_id:i,group_id:n,value:"",param:e.val()}),type:"post",dataType:"html",success:function(e){d.replaceWith(e)}})}},acf.field_group.options={$el:null,init:function(){this.$el=acf.field_group.$options;var e=this.$el.find('tr[data-name="hide_on_screen"] ul'),t=$('<li><label><input type="checkbox" value="" name="" >'+acf._e("hide_show_all")+"</label></li>");0==e.find("input:not(:checked)").length&&t.find("input").attr("checked","checked"),t.on("change","input",function(){var t=$(this).is(":checked");e.find("input").attr("checked",t)}),e.prepend(t)}},acf.add_action("ready",function(){acf.field_group.init()}),acf.add_action("open_field change_field_type",function(e){e.find("tr[data-append]").each(function(){var e=$(this).data("append");if($sibling=$(this).siblings('[data-name="'+e+'"]'),$sibling.exists()){var t=$sibling.children(".acf-input"),i=t.children(".acf-hl");i.exists()||(t.wrapInner('<ul class="acf-hl"><li></li></ul>'),i=t.children(".acf-hl"));var a=$("<li></li>").append($(this).children(".acf-input").children());i.append(a),i.attr("data-cols",i.children().length),$(this).remove()}})}),acf.add_action("open_field change_field_type",function(t){"select"==t.attr("data-type")&&(t.find('.acf-field[data-name="ui"] input[type="radio"]').attr("data-name","toggle-select-ui"),e(t))}),$(document).on("change",'[data-name="toggle-select-ui"]',function(){e(acf.field_group.focus($(this)))}),acf.add_action("open_field change_field_type",function(e){"radio"==e.attr("data-type")&&(e.find('.acf-field[data-name="other_choice"] input[type="checkbox"]').attr("data-name","toggle-radio-other"),t(e))}),$(document).on("change",'[data-name="toggle-radio-other"]',function(){t(acf.field_group.focus($(this)))}),acf.add_action("open_field change_field_type",function(e){"date_picker"==e.attr("data-type")&&i(e)}),$(document).on("change",'.acf-field-object-date-picker input[type="radio"]',function(){i(acf.field_group.focus($(this)))}),acf.add_action("change_field_label change_field_type",function(e){"tab"==e.attr("data-type")&&e.find('tr[data-name="name"]:first input').val("").trigger("change")}),acf.add_action("change_field_label change_field_type",function(e){"message"==e.attr("data-type")&&e.find('tr[data-name="name"]:first input').val("").trigger("change")})}(jQuery);
